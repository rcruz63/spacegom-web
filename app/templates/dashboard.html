{% extends "base.html" %}

{% block content %}
<!-- Main Spacegom Dashboard -->
<div class="space-y-6">
    <!-- HUD SUPERIOR - ESTADO CRÍTICO -->
    <div class="glass-panel tech-border p-6 rounded-lg">
        <div class="grid grid-cols-1 md:grid-cols-4 gap-4">
            <!-- Reserva de Combustible -->
            <div>
                <div class="text-xs text-gray-500 uppercase mb-2 tracking-wider">COMBUSTIBLE</div>
                <div class="relative h-32 bg-space-800 rounded border border-gray-700 p-2">
                    <div class="absolute bottom-0 left-0 right-0 bg-gradient-to-t from-neon-blue to-cyan-400 rounded transition-all duration-300" 
                         style="height: 60%;" id="fuel-level">
                    </div>
                    <div class="absolute inset-0 flex items-center justify-center">
                        <span class="text-3xl font-orbitron text-white font-bold z-10" id="fuel-value">18</span>
                        <span class="text-sm text-gray-400 ml-1 z-10">/30</span>
                    </div>
                </div>
                <div class="mt-2 flex gap-1">
                    <button onclick="adjustFuel(-1)" class="flex-1 bg-space-800 hover:bg-space-700 border border-gray-700 text-neon-red py-1 rounded text-xs">-</button>
                    <button onclick="adjustFuel(1)" class="flex-1 bg-space-800 hover:bg-space-700 border border-gray-700 text-neon-green py-1 rounded text-xs">+</button>
                </div>
            </div>

            <!-- Capacidad del Almacén -->
            <div>
                <div class="text-xs text-gray-500 uppercase mb-2 tracking-wider">ALMACÉN (UCN)</div>
                <div class="relative h-32 bg-space-800 rounded border border-gray-700 p-2">
                    <div class="absolute bottom-0 left-0 right-0 bg-gradient-to-t from-neon-green to-green-400 rounded transition-all duration-300" 
                         style="height: 40%;" id="storage-level">
                    </div>
                    <div class="absolute inset-0 flex items-center justify-center">
                        <span class="text-3xl font-orbitron text-white font-bold z-10" id="storage-value">16</span>
                        <span class="text-sm text-gray-400 ml-1 z-10">/40</span>
                    </div>
                </div>
                <div class="mt-2 flex gap-1">
                    <button onclick="adjustStorage(-1)" class="flex-1 bg-space-800 hover:bg-space-700 border border-gray-700 text-neon-red py-1 rounded text-xs">-</button>
                    <button onclick="adjustStorage(1)" class="flex-1 bg-space-800 hover:bg-space-700 border border-gray-700 text-neon-green py-1 rounded text-xs">+</button>
                </div>
            </div>

            <!-- Sistema de Daños -->
            <div>
                <div class="text-xs text-gray-500 uppercase mb-2 tracking-wider">ESTADO DE DAÑOS</div>
                <div class="space-y-2">
                    <div class="bg-space-800 border border-gray-700 rounded p-2 flex items-center justify-between cursor-pointer hover:bg-space-700" onclick="toggleDamage('light')">
                        <span class="text-xs">LEVES</span>
                        <div id="damage-light" class="w-4 h-4 rounded-full border-2 border-yellow-500"></div>
                    </div>
                    <div class="bg-space-800 border border-gray-700 rounded p-2 flex items-center justify-between cursor-pointer hover:bg-space-700" onclick="toggleDamage('moderate')">
                        <span class="text-xs">MODERADOS</span>
                        <div id="damage-moderate" class="w-4 h-4 rounded-full border-2 border-orange-500"></div>
                    </div>
                    <div class="bg-space-800 border border-gray-700 rounded p-2 flex items-center justify-between cursor-pointer hover:bg-space-700" onclick="toggleDamage('severe')">
                        <span class="text-xs">GRAVES</span>
                        <div id="damage-severe" class="w-4 h-4 rounded-full border-2 border-neon-red"></div>
                    </div>
                </div>
                <!-- Alerta Crítica -->
                <div id="critical-alert" class="hidden mt-3 bg-neon-red bg-opacity-20 border-2 border-neon-red rounded p-2 animate-pulse">
                    <div class="text-neon-red text-xs font-bold text-center">⚠ HIPERSALTO DESTRUIDO</div>
                </div>
            </div>

            <!-- Calendario y Reputación -->
            <div>
                <div class="text-xs text-gray-500 uppercase mb-2 tracking-wider">CALENDARIO</div>
                <div class="bg-space-800 border border-gray-700 rounded p-3 mb-3">
                    <div class="text-xs text-gray-400 mb-1">Mes de Campaña</div>
                    <div class="flex items-center gap-2">
                        <button onclick="adjustMonth(-1)" class="text-neon-blue hover:text-neon-green">◄</button>
                        <span class="text-2xl font-orbitron text-neon-blue flex-1 text-center" id="month-value">3</span>
                        <button onclick="adjustMonth(1)" class="text-neon-blue hover:text-neon-green">►</button>
                    </div>
                    <div class="text-xs text-gray-500 text-center mt-1">de 12</div>
                </div>
                
                <div class="text-xs text-gray-500 uppercase mb-2 tracking-wider">REPUTACIÓN</div>
                <div class="bg-space-800 border border-gray-700 rounded p-3">
                    <div class="flex items-center gap-2">
                        <button onclick="adjustReputation(-1)" class="text-neon-red hover:text-red-400">◄</button>
                        <span class="text-2xl font-orbitron flex-1 text-center" id="reputation-value" style="color: #00ff9d;">+2</span>
                        <button onclick="adjustReputation(1)" class="text-neon-green hover:text-green-400">►</button>
                    </div>
                    <div class="text-xs text-gray-500 text-center mt-1">-5 a +5</div>
                </div>
            </div>
        </div>
    </div>

    <!-- GRID: Navegación y Plantilla -->
    <div class="grid grid-cols-1 lg:grid-cols-2 gap-6">
        <!-- MÓDULO DE NAVEGACIÓN - VISTA DE CUADRANTE -->
        <div class="glass-panel tech-border p-6 rounded-lg">
            <h2 class="text-xl font-orbitron text-neon-blue mb-4 border-b border-gray-700 pb-2">
                VISTA DE CUADRANTE
            </h2>
            
            <!-- Grid 6x6 -->
            <div class="grid grid-cols-6 gap-1 mb-4">
                <!-- Generate 36 cells via JavaScript for interactivity -->
                <script>
                    const quadrantData = {
                        '2-3': { explored: true, planet: 'Bretobos', code: '466' },
                        '4-1': { explored: true, planet: 'Nexus-7', code: '112' }
                    };
                </script>
                {% for i in range(36) %}
                <div id="quad-{{ i }}" 
                     class="quadrant-cell aspect-square bg-space-800 border border-gray-700 hover:border-neon-blue cursor-pointer transition-all rounded flex items-center justify-center text-xs font-tech relative overflow-hidden"
                     onclick="selectQuadrant({{ i // 6 }}, {{ i % 6 }})">
                    <div class="fog-overlay absolute inset-0 bg-black bg-opacity-70 backdrop-blur-sm"></div>
                    <span class="text-gray-600 text-[8px] z-10">{{ '%d,%d' % (i // 6, i % 6) }}</span>
                </div>
                {% endfor %}
            </div>

            <!-- Panel de Información del Planeta -->
            <div id="planet-info" class="hidden">
                <div class="bg-space-800 border border-neon-blue rounded p-4">
                    <div class="flex items-start justify-between mb-3">
                        <div>
                            <div class="text-neon-blue font-orbitron text-lg" id="planet-name">BRETOBOS</div>
                            <div class="text-gray-500 text-xs" id="planet-code">Código: 466</div>
                        </div>
                        <button onclick="closePlanetInfo()" class="text-gray-500 hover:text-neon-red">✕</button>
                    </div>
                    
                    <div class="space-y-2 text-sm">
                        <div class="flex justify-between border-b border-gray-700 pb-2">
                            <span class="text-gray-400">Soporte Vital:</span>
                            <span class="text-neon-green" id="planet-life-support">RF - Respirador/Filtraje</span>
                        </div>
                        <div class="flex justify-between border-b border-gray-700 pb-2">
                            <span class="text-gray-400">Espaciopuerto:</span>
                            <span class="text-white" id="planet-spaceport">Clase B</span>
                        </div>
                        <div class="border-t border-gray-700 pt-2 mt-2">
                            <div class="text-gray-400 text-xs mb-2">Instalaciones Orbitales:</div>
                            <div id="planet-facilities" class="flex flex-wrap gap-1">
                                <span class="px-2 py-1 bg-neon-blue bg-opacity-20 border border-neon-blue rounded text-xs">Centro Cartografía</span>
                                <span class="px-2 py-1 bg-neon-green bg-opacity-20 border border-neon-green rounded text-xs">Academia</span>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- GESTIÓN DE PLANTILLA - BIO-MÉTRICAS -->
        <div class="glass-panel tech-border p-6 rounded-lg">
            <h2 class="text-xl font-orbitron text-neon-blue mb-4 border-b border-gray-700 pb-2">
                TRIPULACIÓN
            </h2>

            <!-- Indicador de Salubridad -->
            <div class="mb-4 bg-space-800 border border-gray-700 rounded p-3">
                <div class="flex items-center justify-between mb-2">
                    <span class="text-xs text-gray-400 uppercase">Salubridad</span>
                    <span class="text-neon-green font-orbitron" id="health-level">MEDIA</span>
                </div>
                <div class="w-full bg-gray-800 rounded-full h-2">
                    <div class="bg-gradient-to-r from-neon-red via-yellow-500 to-neon-green h-2 rounded-full transition-all" style="width: 60%;"></div>
                </div>
                <div class="text-xs text-gray-500 mt-1">↓ Riesgo de fallecimientos / fin de partida</div>
            </div>

            <!-- Tarjetas de Tripulantes -->
            <div class="space-y-3 max-h-96 overflow-y-auto">
                <!-- Tripulante 1 -->
                <div class="bg-space-800 border border-gray-700 rounded p-3 hover:border-neon-blue transition-all">
                    <div class="flex items-start justify-between mb-2">
                        <div>
                            <div class="font-orbitron text-white">Elena Voss</div>
                            <div class="text-xs text-neon-blue">PILOTO</div>
                        </div>
                        <div class="text-right">
                            <div class="text-xs text-gray-400">Salario</div>
                            <div class="text-white font-tech">1,200 <span class="text-gray-500 text-xs">SC</span></div>
                        </div>
                    </div>
                    <div class="flex items-center justify-between text-xs">
                        <div class="flex gap-2">
                            <span class="px-2 py-1 bg-cyan-500 bg-opacity-20 border border-cyan-500 rounded text-cyan-400">VETERANA</span>
                        </div>
                        <div class="flex items-center gap-1">
                            <span class="text-gray-400">Moral:</span>
                            <div class="flex gap-1">
                                <div class="w-2 h-4 bg-neon-green rounded"></div>
                                <div class="w-2 h-4 bg-neon-green rounded"></div>
                                <div class="w-2 h-4 bg-gray-700 rounded"></div>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Tripulante 2 -->
                <div class="bg-space-800 border border-gray-700 rounded p-3 hover:border-neon-blue transition-all">
                    <div class="flex items-start justify-between mb-2">
                        <div>
                            <div class="font-orbitron text-white">Marcus Chen</div>
                            <div class="text-xs text-neon-blue">INGENIERO</div>
                        </div>
                        <div class="text-right">
                            <div class="text-xs text-gray-400">Salario</div>
                            <div class="text-white font-tech">950 <span class="text-gray-500 text-xs">SC</span></div>
                        </div>
                    </div>
                    <div class="flex items-center justify-between text-xs">
                        <div class="flex gap-2">
                            <span class="px-2 py-1 bg-gray-500 bg-opacity-20 border border-gray-500 rounded text-gray-400">ESTÁNDAR</span>
                        </div>
                        <div class="flex items-center gap-1">
                            <span class="text-gray-400">Moral:</span>
                            <div class="flex gap-1">
                                <div class="w-2 h-4 bg-neon-green rounded"></div>
                                <div class="w-2 h-4 bg-neon-green rounded"></div>
                                <div class="w-2 h-4 bg-neon-green rounded"></div>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Tripulante 3 -->
                <div class="bg-space-800 border border-gray-700 rounded p-3 hover:border-neon-blue transition-all">
                    <div class="flex items-start justify-between mb-2">
                        <div>
                            <div class="font-orbitron text-white">Zara Kaine</div>
                            <div class="text-xs text-neon-blue">NEGOCIADORA</div>
                        </div>
                        <div class="text-right">
                            <div class="text-xs text-gray-400">Salario</div>
                            <div class="text-white font-tech">800 <span class="text-gray-500 text-xs">SC</span></div>
                        </div>
                    </div>
                    <div class="flex items-center justify-between text-xs">
                        <div class="flex gap-2">
                            <span class="px-2 py-1 bg-green-500 bg-opacity-20 border border-green-500 rounded text-green-400">NOVATA</span>
                        </div>
                        <div class="flex items-center gap-1">
                            <span class="text-gray-400">Moral:</span>
                            <div class="flex gap-1">
                                <div class="w-2 h-4 bg-neon-red rounded"></div>
                                <div class="w-2 h-4 bg-gray-700 rounded"></div>
                                <div class="w-2 h-4 bg-gray-700 rounded"></div>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Botón Agregar Tripulante -->
                <button class="w-full border-2 border-dashed border-gray-700 hover:border-neon-blue rounded p-3 text-gray-500 hover:text-neon-blue transition-all">
                    + RECLUTAR TRIPULANTE
                </button>
            </div>
        </div>
    </div>

    <!-- TERMINAL COMERCIAL Y TESORERÍA -->
    <div class="glass-panel tech-border p-6 rounded-lg">
        <h2 class="text-xl font-orbitron text-neon-blue mb-4 border-b border-gray-700 pb-2">
            TERMINAL COMERCIAL
        </h2>

        <div class="grid grid-cols-1 lg:grid-cols-3 gap-6">
            <!-- Tabla de Mercancías -->
            <div class="lg:col-span-2">
                <div class="overflow-x-auto">
                    <table class="w-full text-sm">
                        <thead>
                            <tr class="border-b border-gray-700">
                                <th class="text-left py-2 text-xs text-gray-400 font-tech uppercase">Mercancía</th>
                                <th class="text-center py-2 text-xs text-gray-400 font-tech uppercase">Precio Base</th>
                                <th class="text-center py-2 text-xs text-gray-400 font-tech uppercase">Modificador</th>
                                <th class="text-center py-2 text-xs text-gray-400 font-tech uppercase">Precio Final</th>
                                <th class="text-center py-2 text-xs text-gray-400 font-tech uppercase">Acción</th>
                            </tr>
                        </thead>
                        <tbody id="trade-table" class="font-tech">
                            <tr class="border-b border-gray-800 hover:bg-space-800">
                                <td class="py-3">Minerales Básicos</td>
                                <td class="text-center text-neon-blue">500 CR</td>
                                <td class="text-center">
                                    <select class="bg-space-800 border border-gray-700 rounded px-2 py-1 text-xs" onchange="updatePrice(this, 0)">
                                        <option value="0.8">x0.8 (Mal)</option>
                                        <option value="1.0" selected>x1.0 (Normal)</option>
                                        <option value="1.2">x1.2 (Bueno)</option>
                                    </select>
                                </td>
                                <td class="text-center text-neon-green font-bold" id="price-0">500 CR</td>
                                <td class="text-center">
                                    <div class="flex gap-1 justify-center">
                                        <button class="px-3 py-1 bg-neon-blue bg-opacity-20 border border-neon-blue text-neon-blue rounded text-xs hover:bg-opacity-30">COMPRAR</button>
                                        <button class="px-3 py-1 bg-neon-green bg-opacity-20 border border-neon-green text-neon-green rounded text-xs hover:bg-opacity-30">VENDER</button>
                                    </div>
                                </td>
                            </tr>
                            <tr class="border-b border-gray-800 hover:bg-space-800">
                                <td class="py-3">Componentes Electrónicos</td>
                                <td class="text-center text-neon-blue">1,200 CR</td>
                                <td class="text-center">
                                    <select class="bg-space-800 border border-gray-700 rounded px-2 py-1 text-xs" onchange="updatePrice(this, 1)">
                                        <option value="0.8">x0.8 (Mal)</option>
                                        <option value="1.0" selected>x1.0 (Normal)</option>
                                        <option value="1.2">x1.2 (Bueno)</option>
                                    </select>
                                </td>
                                <td class="text-center text-neon-green font-bold" id="price-1">1,200 CR</td>
                                <td class="text-center">
                                    <div class="flex gap-1 justify-center">
                                        <button class="px-3 py-1 bg-neon-blue bg-opacity-20 border border-neon-blue text-neon-blue rounded text-xs hover:bg-opacity-30">COMPRAR</button>
                                        <button class="px-3 py-1 bg-neon-green bg-opacity-20 border border-neon-green text-neon-green rounded text-xs hover:bg-opacity-30">VENDER</button>
                                    </div>
                                </td>
                            </tr>
                            <tr class="border-b border-gray-800 hover:bg-space-800">
                                <td class="py-3">Medicamentos</td>
                                <td class="text-center text-neon-blue">800 CR</td>
                                <td class="text-center">
                                    <select class="bg-space-800 border border-gray-700 rounded px-2 py-1 text-xs" onchange="updatePrice(this, 2)">
                                        <option value="0.8">x0.8 (Mal)</option>
                                        <option value="1.0" selected>x1.0 (Normal)</option>
                                        <option value="1.2">x1.2 (Bueno)</option>
                                    </select>
                                </td>
                                <td class="text-center text-neon-green font-bold" id="price-2">800 CR</td>
                                <td class="text-center">
                                    <div class="flex gap-1 justify-center">
                                        <button class="px-3 py-1 bg-neon-blue bg-opacity-20 border border-neon-blue text-neon-blue rounded text-xs hover:bg-opacity-30">COMPRAR</button>
                                        <button class="px-3 py-1 bg-neon-green bg-opacity-20 border border-neon-green text-neon-green rounded text-xs hover:bg-opacity-30">VENDER</button>
                                    </div>
                                </td>
                            </tr>
                            <tr class="border-b border-gray-800 hover:bg-space-800">
                                <td class="py-3">Armas y Munición</td>
                                <td class="text-center text-neon-blue">2,500 CR</td>
                                <td class="text-center">
                                    <select class="bg-space-800 border border-gray-700 rounded px-2 py-1 text-xs" onchange="updatePrice(this, 3)">
                                        <option value="0.8">x0.8 (Mal)</option>
                                        <option value="1.0" selected>x1.0 (Normal)</option>
                                        <option value="1.2">x1.2 (Bueno)</option>
                                    </select>
                                </td>
                                <td class="text-center text-neon-green font-bold" id="price-3">2,500 CR</td>
                                <td class="text-center">
                                    <div class="flex gap-1 justify-center">
                                        <button class="px-3 py-1 bg-neon-blue bg-opacity-20 border border-neon-blue text-neon-blue rounded text-xs hover:bg-opacity-30">COMPRAR</button>
                                        <button class="px-3 py-1 bg-neon-green bg-opacity-20 border border-neon-green text-neon-green rounded text-xs hover:bg-opacity-30">VENDER</button>
                                    </div>
                                </td>
                            </tr>
                        </tbody>
                    </table>
                </div>
            </div>

            <!-- Resumen Financiero -->
            <div class="space-y-4">
                <!-- Tesorería Actual -->
                <div class="bg-space-800 border border-neon-blue rounded p-4">
                    <div class="text-xs text-gray-400 uppercase mb-2">Tesorería</div>
                    <div class="text-3xl font-orbitron text-neon-blue">45,230</div>
                    <div class="text-xs text-gray-500">Créditos</div>
                </div>

                <!-- Administración Semanal -->
                <div class="bg-space-800 border border-gray-700 rounded p-4">
                    <div class="text-xs text-neon-green uppercase mb-3 border-b border-gray-700 pb-2">Gastos Semanales</div>
                    <div class="space-y-2 text-sm">
                        <div class="flex justify-between">
                            <span class="text-gray-400">Salarios:</span>
                            <span class="text-neon-red">-2,950 CR</span>
                        </div>
                        <div class="flex justify-between">
                            <span class="text-gray-400">Mantenimiento:</span>
                            <span class="text-neon-red">-500 CR</span>
                        </div>
                        <div class="flex justify-between border-t border-gray-700 pt-2 font-bold">
                            <span>Total:</span>
                            <span class="text-neon-red">-3,450 CR</span>
                        </div>
                    </div>
                </div>

                <!-- Administración Mensual -->
                <div class="bg-space-800 border border-gray-700 rounded p-4">
                    <div class="text-xs text-orange-400 uppercase mb-3 border-b border-gray-700 pb-2">Préstamos Mensuales</div>
                    <div class="space-y-2 text-sm">
                        <div class="flex justify-between">
                            <span class="text-gray-400">Banco Galáctico:</span>
                            <span class="text-neon-red">-5,000 CR</span>
                        </div>
                        <div class="flex justify-between">
                            <span class="text-gray-400">Mejoras Nave:</span>
                            <span class="text-neon-red">-2,000 CR</span>
                        </div>
                        <div class="flex justify-between border-t border-gray-700 pt-2 font-bold">
                            <span>Total:</span>
                            <span class="text-neon-red">-7,000 CR</span>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>

<script>
// Estado del juego
let gameState = {
    fuel: 18,
    storage: 16,
    month: 3,
    reputation: 2,
    damages: {
        light: false,
        moderate: false,
        severe: false
    }
};

// Funciones de ajuste
function adjustFuel(delta) {
    gameState.fuel = Math.max(0, Math.min(30, gameState.fuel + delta));
    updateFuelDisplay();
}

function adjustStorage(delta) {
    gameState.storage = Math.max(0, Math.min(40, gameState.storage + delta));
    updateStorageDisplay();
}

function adjustMonth(delta) {
    gameState.month = Math.max(1, Math.min(12, gameState.month + delta));
    document.getElementById('month-value').textContent = gameState.month;
}

function adjustReputation(delta) {
    gameState.reputation = Math.max(-5, Math.min(5, gameState.reputation + delta));
    updateReputationDisplay();
}

function updateFuelDisplay() {
    const percentage = (gameState.fuel / 30) * 100;
    document.getElementById('fuel-level').style.height = percentage + '%';
    document.getElementById('fuel-value').textContent = gameState.fuel;
    
    // Cambiar color si está bajo
    const fuelLevel = document.getElementById('fuel-level');
    if (gameState.fuel < 10) {
        fuelLevel.className = fuelLevel.className.replace('from-neon-blue to-cyan-400', 'from-neon-red to-red-400');
    } else {
        fuelLevel.className = fuelLevel.className.replace('from-neon-red to-red-400', 'from-neon-blue to-cyan-400');
    }
}

function updateStorageDisplay() {
    const percentage = (gameState.storage / 40) * 100;
    document.getElementById('storage-level').style.height = percentage + '%';
    document.getElementById('storage-value').textContent = gameState.storage;
}

function updateReputationDisplay() {
    const el = document.getElementById('reputation-value');
    const val = gameState.reputation;
    el.textContent = val >= 0 ? '+' + val : val;
    
    // Color según reputación
    if (val >= 3) el.style.color = '#00ff9d';
    else if (val >= 0) el.style.color = '#00f3ff';
    else if (val >= -2) el.style.color = '#ffa500';
    else el.style.color = '#ff2a6d';
}

function toggleDamage(type) {
    gameState.damages[type] = !gameState.damages[type];
    const el = document.getElementById('damage-' + type);
    
    if (gameState.damages[type]) {
        el.classList.add('bg-opacity-100');
        if (type === 'light') el.className = el.className.replace('border-yellow-500', 'border-yellow-500 bg-yellow-500');
        if (type === 'moderate') el.className = el.className.replace('border-orange-500', 'border-orange-500 bg-orange-500');
        if (type === 'severe') el.className = el.className.replace('border-neon-red', 'border-neon-red bg-neon-red');
    } else {
        if (type === 'light') el.className = 'w-4 h-4 rounded-full border-2 border-yellow-500';
        if (type === 'moderate') el.className = 'w-4 h-4 rounded-full border-2 border-orange-500';
        if (type === 'severe') el.className = 'w-4 h-4 rounded-full border-2 border-neon-red';
    }
    
    // Mostrar alerta crítica si hay daños graves
    const alert = document.getElementById('critical-alert');
    if (gameState.damages.severe) {
        alert.classList.remove('hidden');
    } else {
        alert.classList.add('hidden');
    }
}

function selectQuadrant(row, col) {
    const key = row + '-' + col;
    const cell = document.getElementById('quad-' + (row * 6 + col));
    
    // Remover niebla de guerra
    const fog = cell.querySelector('.fog-overlay');
    if (fog) {
        fog.classList.add('opacity-0');
        setTimeout(() => fog.remove(), 300);
    }
    
    // Marcar como explorado
    cell.classList.add('border-neon-green');
    cell.style.backgroundColor = '#1f2640';
    
    // Si hay un planeta, mostrar info
    if (quadrantData[key]) {
        showPlanetInfo(quadrantData[key]);
        cell.innerHTML = `<span class="text-neon-green font-bold z-10">${quadrantData[key].code}</span>`;
    }
}

function showPlanetInfo(planet) {
    document.getElementById('planet-info').classList.remove('hidden');
    document.getElementById('planet-name').textContent = planet.planet.toUpperCase();
    document.getElementById('planet-code').textContent = 'Código: ' + planet.code;
}

function closePlanetInfo() {
    document.getElementById('planet-info').classList.add('hidden');
}

function updatePrice(select, index) {
    const basePrices = [500, 1200, 800, 2500];
    const modifier = parseFloat(select.value);
    const finalPrice = Math.round(basePrices[index] * modifier);
    document.getElementById('price-' + index).textContent = finalPrice + ' CR';
}
</script>
{% endblock %}
